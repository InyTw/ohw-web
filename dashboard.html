<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OHW - 玩家中心 & 贊助商店</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="script/dash.js"></script>
    <script src="script/store.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        /* 主題變數 */
        :root {
            --bg-color: #000;
            --text-color: #ffffff;
            --card-bg: rgba(15, 15, 15, 0.8);
            --nav-bg: #0d1117;
            --border-color: rgba(255, 255, 255, 0.05);
            --grid-opacity: 0.03;
            --transition-speed: 0.5s;
        }

        body.theme-light {
            --bg-color: #f3f4f6;
            --text-color: #111827;
            --card-bg: rgba(255, 255, 255, 0.9);
            --nav-bg: #ffffff;
            --border-color: rgba(0, 0, 0, 0.1);
            --grid-opacity: 0.1;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Inter', "Microsoft JhengHei", sans-serif;
            overflow-x: hidden;
            transition: background-color var(--transition-speed), color var(--transition-speed);
        }

        .grid-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(circle at 2px 2px, var(--text-color) var(--grid-opacity), transparent 0);
            background-size: 30px 30px;
            z-index: -1;
        }

        .glass {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .nav-link-active {
            background: rgba(79, 70, 229, 0.1);
            color: #4f46e5;
            border-left: 4px solid #4f46e5;
        }

        aside { background-color: var(--nav-bg); border-right: 1px solid var(--border-color); }

        .store-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 28px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; flex-direction: column;
        }

        .store-card:hover { transform: translateY(-10px); border-color: #6366f1; }

        .rank-vip { border-top: 5px solid #22c55e; }
        .rank-mvp { border-top: 5px solid #06b6d4; }
        .rank-mvppp { border-top: 5px solid #f59e0b; }

        .price-tag { font-size: 1.8rem; font-weight: 900; color: var(--text-color); }
        .buy-btn { background: #4f46e5; color: #fff; font-weight: 900; text-transform: uppercase; }
        .btn-ultimate { background: linear-gradient(90deg, #f59e0b, #ea580c); color: white; }
        .btn-gradient { background: linear-gradient(90deg, #6366f1, #a855f7); color: white; }

        .theme-option { cursor: pointer; border: 2px solid var(--border-color); padding: 1rem; border-radius: 1rem; transition: 0.3s; }
        .theme-option.active { border-color: #6366f1; background: rgba(99, 102, 241, 0.1); }
    </style>
</head>

<body class="flex min-h-screen">
    <div class="grid-bg"></div>

    <aside class="w-64 flex flex-col fixed inset-y-0 left-0 z-50">
        <div class="p-8">
            <div class="text-2xl font-black tracking-tighter text-indigo-500 italic">OHW NETWORK</div>
        </div>
        <nav class="flex-grow px-4 space-y-2">
            <button onclick="switchTab('overview')" id="nav-overview" class="nav-btn w-full nav-link-active flex items-center gap-4 px-4 py-3 rounded-xl font-bold text-sm text-left">
                <i class="fas fa-th-large"></i><span>Overview</span>
            </button>
            <button onclick="switchTab('store')" id="nav-store" class="nav-btn w-full flex items-center gap-4 text-gray-500 hover:text-indigo-500 px-4 py-3 rounded-xl font-bold text-sm text-left">
                <i class="fas fa-shopping-cart"></i><span>Store</span>
            </button>
            <button onclick="switchTab('rules')" id="nav-rules" class="nav-btn w-full flex items-center gap-4 text-gray-500 hover:text-indigo-500 px-4 py-3 rounded-xl font-bold text-sm text-left">
                <i class="fas fa-gavel"></i><span>Rules</span>
            </button>
        </nav>

        <div class="p-4 border-t border-[var(--border-color)]">
            <div class="relative">
                <div id="user-dropdown" class="hidden absolute bottom-16 left-0 right-0 bg-[var(--nav-bg)] border border-[var(--border-color)] rounded-2xl shadow-2xl py-2 z-50">
                    <button onclick="switchTab('settings')" class="w-full flex items-center gap-3 px-4 py-3 text-sm text-gray-500 hover:text-indigo-500 text-left">
                        <i class="fas fa-user-cog"></i> 個人設定
                    </button>
                    <button onclick="logout()" class="w-full flex items-center gap-3 px-4 py-3 text-sm text-red-500 text-left">
                        <i class="fas fa-sign-out-alt"></i> 登出帳號
                    </button>
                </div>
                <div class="bg-black/5 rounded-2xl p-3 border border-[var(--border-color)] flex items-center justify-between cursor-pointer" onclick="toggleUserMenu(event)">
                    <div class="flex items-center gap-3 overflow-hidden">
                        <img id="dash-avatar" src="" class="w-9 h-9 rounded-full bg-gray-800 border border-indigo-500/50">
                        <div>
                            <p id="dash-username" class="text-xs font-bold truncate">Loading...</p>
                            <p class="text-[8px] text-green-500 font-black">ONLINE</p>
                        </div>
                    </div>
                    <i class="fas fa-chevron-up text-[10px] text-gray-500"></i>
                </div>
            </div>
        </div>
    </aside>

    <main class="flex-grow ml-64 p-10 lg:p-16">
        <div id="overview-section" class="tab-content">
            <header class="mb-12">
                <h1 class="text-5xl font-black tracking-tighter uppercase italic">Overview</h1>
                <p class="text-indigo-500 font-bold mt-2">歡迎回來, <span id="welcome-user">玩家</span>!</p>
            </header>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                <div class="glass p-8 rounded-[2rem]">
                    <p class="text-xs font-bold uppercase text-gray-500 mb-4 tracking-widest">My Balance</p>
                    <h2 class="text-4xl font-black"><span id="coin-balance">--</span> <span class="text-sm font-bold opacity-50 uppercase">Coins</span></h2>
                </div>
                <div class="glass p-8 rounded-[2rem]">
                    <p class="text-xs font-bold uppercase text-gray-500 mb-4 tracking-widest">Daily Reward</p>
                    <button onclick="claimReward()" id="claim-btn" class="w-full bg-indigo-600 text-white font-black py-4 rounded-2xl hover:bg-indigo-500 transition shadow-lg shadow-indigo-500/20">CLAIM 10 COINS</button>
                </div>
            </div>
        </div>

        <div id="store-section" class="tab-content hidden">
            <header class="mb-12"><h1 class="text-5xl font-black tracking-tighter uppercase italic">Rank Store</h1></header>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <div class="store-card p-6 rank-vip"><h3 class="font-black text-green-500">[VIP]</h3><div class="price-tag mb-4">$100</div><button onclick="openCheckout('[VIP]', '$100')" class="buy-btn w-full py-2 rounded-xl text-xs">購買</button></div>
                </div>
        </div>

        <div id="settings-section" class="tab-content hidden">
            <header class="mb-12"><h1 class="text-5xl font-black tracking-tighter uppercase italic">Settings</h1></header>
            <div class="glass p-8 rounded-[2.5rem] max-w-2xl">
                <h3 class="text-xs font-black uppercase text-indigo-500 mb-6 italic">Appearance</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div onclick="setTheme('dark')" id="theme-dark-btn" class="theme-option text-center">
                        <i class="fas fa-moon block mb-2"></i><span class="text-sm font-bold">Dark Mode</span>
                    </div>
                    <div onclick="setTheme('light')" id="theme-light-btn" class="theme-option text-center">
                        <i class="fas fa-sun block mb-2"></i><span class="text-sm font-bold">Light Mode</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // 分頁、菜單、彈窗邏輯
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('nav-link-active'));
            document.getElementById(tabId + '-section').classList.remove('hidden');
            document.getElementById('nav-' + tabId).classList.add('nav-link-active');
            document.getElementById('user-dropdown').classList.add('hidden');
        }

        function setTheme(theme) {
            const body = document.body;
            body.style.opacity = "0.7";
            setTimeout(() => {
                if (theme === 'light') {
                    body.classList.add('theme-light');
                    document.getElementById('theme-light-btn').classList.add('active');
                    document.getElementById('theme-dark-btn').classList.remove('active');
                } else {
                    body.classList.remove('theme-light');
                    document.getElementById('theme-dark-btn').classList.add('active');
                    document.getElementById('theme-light-btn').classList.remove('active');
                }
                body.style.opacity = "1";
                localStorage.setItem('user-theme', theme);
            }, 100);
        }

        // 初始化主題
        setTheme(localStorage.getItem('user-theme') || 'dark');

        function toggleUserMenu(e) { e.stopPropagation(); document.getElementById('user-dropdown').classList.toggle('hidden'); }
        window.onclick = () => document.getElementById('user-dropdown').classList.add('hidden');
    </script>
</body>
</html>